<!DOCTYPE html>
<html lang="en" class="dark">
    <head>
        <script src="https://cdn.tailwindcss.com"></script>
        <title>Live Log for {{service}}</title>
    </head>

    <body class="dark:bg-gray-900">

        <div class="flex items-center py-2 px-3">
            <h1 class="text-3xl text-slate-300">Live Log for {{service}}</h1>
        </div>
        <br>

        <div class="flex items-center py-2 px-3">
            <h2 class="text-2xl text-slate-400 overline decoration-4 decoration-pink-500">
                <button type="button" class="btn btn-primary btn-sm" onclick="switch_log_size()">
                    Change Log Size
                </button>
            </h2>
        </div>

        <div class="flex items-center py-2 px-3">
            <div
                id="logs"
                class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                style="overflow-y: auto;height: 450px;"
            >
            reading logs...
            </div>
        </div>

        <script>
            let loc = window.location, new_uri;
            if (loc.protocol === "https:") {
                new_uri = "wss:";
            } else {
                new_uri = "ws:";
            }
            new_uri += "//" + loc.host;
            new_uri += "/ws/live_log/{{service}}";

            let ws_log = new WebSocket(new_uri);

            ws_log.onmessage = function (event) {
                console.log(event.data);

                let logs = document.getElementById("logs");
                logs.innerHTML = event.data;
            };

            function switch_log_size()
            {
                ws_log.send(JSON.stringify({
                    type: "switch_log_size",
                    value: 1
                }));
            }
        </script>
    </body>
</html>